summary(WFD.occu.2)
WFD.occu.3 <- occu(~temp ~1, WFD.UMF)
summary(WFD.occu.3)
WFD.occu.5 <- occu(~temp + effort ~ water + scrub, WFD.UMF)
### Doesn't work when predictors not scaled but works for best model
WFD.mods <- fitList(WFD.occu, WFD.occu.1, WFD.occu.2, WFD.occu.3, WFD.occu.4, WFD.occu.5, WFD.occu.6, WFD.occu.7, WFD.occu.8, WFD.occu.9, WFD.occu.10, WFD.occu.11,WFD.occu.12, WFD.occu.13, WFD.occu.14, WFD.occu.15, WFD.occu.16, WFD.occu.17, WFD.occu.18, WFD.occu.19, WFD.occu.20, WFD.occu.21, WFD.occu.22, WFD.occu.23, WFD.occu.24, WFD.occu.25, WFD.occu.26, WFD.occu.27, WFD.occu.28, WFD.occu.29, WFD.occu.30, WFD.occu.31, WFD.occu.32, WFD.occu.33, WFD.occu.34, WFD.occu.35, WFD.occu.36, WFD.occu.37, WFD.occu.38, WFD.occu.39, WFD.occu.40, WFD.occu.41, WFD.occu.42, WFD.occu.43, WFD.occu.44, WFD.occu.45, WFD.occu.46, WFD.occu.47, WFD.occu.48, WFD.occu.49, WFD.occu.50, WFD.occu.51)
WFD.occ.mat
WFD.occ.mat$wood
WFD.occ.mat[50,]
nrow(WFD.occ.mat)
length(WFD.occ.mat)[,1]
length(WFD.occ.mat)[1]
length(WFD.occ.mat[,1])
WFD.occ.mat[63#,]
]
WFD.occ.mat[63,]
WFD.occ.mat[64,]
WFD.occ.mat[65,]
WFD.occ.mat[66,]
WFD.occ.mat[c(40, 41, 47, 49, 57, 58, 59, 63:65),]
WFD.obsCovs <- list(cloud=obsCov.cloud[-c(40, 41, 47, 49, 57, 58, 62:64),], temp=obsCov.temp[-c(40, 41, 47, 49, 57, 58, 62:64),], wind=obsCov.wind[-c(40, 41, 47, 49, 57, 58, 62:64),], effort=obsCov.effort[-c(40, 41, 47, 49, 57, 58, 62:64),])
WFD.UMF <- unmarkedFrameOccu(y = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64),3:15], siteCovs = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64),16:20], obsCovs = WFD.obsCovs)
WFD.occu <- occu(~1 ~1, WFD.UMF)
summary(WFD.occu)
WFD.occu.1 <- occu(~1 ~ moss + scrubMoss + water, WFD.UMF)
WFD.occu.2 <- occu(~1 ~ moss + scrub + water, WFD.UMF)
WFD.occu.3 <- occu(~1 ~ moss + scrubMoss, WFD.UMF)
WFD.occu.4 <- occu(~1 ~ moss + scrub, WFD.UMF)
WFD.occu.5 <- occu(~1 ~ scrubMoss + water, WFD.UMF)
WFD.occu.6 <- occu(~1 ~ scrub + water, WFD.UMF)
WFD.occu.7 <- occu(~1 ~ moss + water, WFD.UMF)
WFD.occu.8 <- occu(~1 ~ moss, WFD.UMF)
WFD.occu.9 <- occu(~1 ~ scrub, WFD.UMF)
WFD.occu.10 <- occu(~1 ~ scrubMoss, WFD.UMF)
WFD.occu.11 <- occu(~1 ~ moss + scrub + water + wood, WFD.UMF)
WFD.occu.12 <- occu(~1 ~ moss + scrub + wood, WFD.UMF)
WFD.occu.13 <- occu(~1 ~ scrub + water + wood, WFD.UMF)
WFD.occu.14 <- occu(~1 ~ moss + water + wood, WFD.UMF)
WFD.occu.15 <- occu(~1 ~ moss + wood, WFD.UMF)
WFD.occu.16 <- occu(~1 ~ scrub + wood, WFD.UMF)
WFD.occu.17 <- occu(~1 ~ wood, WFD.UMF)
WFD.occu.18 <- occu(~wind ~ moss + scrubMoss + water, WFD.UMF)
WFD.occu.19 <- occu(~wind ~ moss + scrub + water, WFD.UMF)
WFD.occu.20 <- occu(~wind ~ moss + scrubMoss, WFD.UMF)
WFD.occu.21 <- occu(~wind ~ moss + scrub, WFD.UMF)
WFD.occu.22 <- occu(~wind ~ scrubMoss + water, WFD.UMF)
WFD.occu.23 <- occu(~wind ~ scrub + water, WFD.UMF)
WFD.occu.24 <- occu(~wind ~ moss + water, WFD.UMF)
WFD.occu.25 <- occu(~wind ~ moss, WFD.UMF)
WFD.occu.26 <- occu(~wind ~ scrub, WFD.UMF)
WFD.occu.27 <- occu(~wind ~ scrubMoss, WFD.UMF)
WFD.occu.28 <- occu(~wind ~ moss + scrub + water + wood, WFD.UMF)
WFD.occu.29 <- occu(~wind ~ moss + scrub + wood, WFD.UMF)
WFD.occu.30 <- occu(~wind ~ scrub + water + wood, WFD.UMF)
WFD.occu.31 <- occu(~wind ~ moss + water + wood, WFD.UMF)
WFD.occu.32 <- occu(~wind ~ moss + wood, WFD.UMF)
WFD.occu.33 <- occu(~wind ~ scrub + wood, WFD.UMF)
WFD.occu.34 <- occu(~wind ~ wood, WFD.UMF)
WFD.occu.35 <- occu(~temp ~ moss + scrubMoss + water, WFD.UMF)
WFD.occu.36 <- occu(~temp ~ moss + scrub + water, WFD.UMF)
WFD.occu.37 <- occu(~temp ~ moss + scrubMoss, WFD.UMF)
WFD.occu.38 <- occu(~temp ~ moss + scrub, WFD.UMF)
WFD.occu.39 <- occu(~temp ~ scrubMoss + water, WFD.UMF)
WFD.occu.40 <- occu(~temp ~ scrub + water, WFD.UMF)
WFD.occu.41 <- occu(~temp ~ moss + water, WFD.UMF)
WFD.occu.42 <- occu(~temp ~ moss, WFD.UMF)
WFD.occu.43 <- occu(~temp ~ scrub, WFD.UMF)
WFD.occu.44 <- occu(~temp ~ scrubMoss, WFD.UMF)
WFD.occu.45 <- occu(~temp ~ moss + scrub + water + wood, WFD.UMF)
WFD.occu.46 <- occu(~temp ~ moss + scrub + wood, WFD.UMF)
WFD.occu.47 <- occu(~temp ~ scrub + water + wood, WFD.UMF)
WFD.occu.48 <- occu(~temp ~ moss + water + wood, WFD.UMF)
WFD.occu.49 <- occu(~temp ~ moss + wood, WFD.UMF)
WFD.occu.50 <- occu(~temp ~ scrub + wood, WFD.UMF)
WFD.occu.51 <- occu(~temp ~ wood, WFD.UMF)
### Doesn't work when predictors not scaled but works for best model
WFD.mods <- fitList(WFD.occu, WFD.occu.1, WFD.occu.2, WFD.occu.3, WFD.occu.4, WFD.occu.5, WFD.occu.6, WFD.occu.7, WFD.occu.8, WFD.occu.9, WFD.occu.10, WFD.occu.11,WFD.occu.12, WFD.occu.13, WFD.occu.14, WFD.occu.15, WFD.occu.16, WFD.occu.17, WFD.occu.18, WFD.occu.19, WFD.occu.20, WFD.occu.21, WFD.occu.22, WFD.occu.23, WFD.occu.24, WFD.occu.25, WFD.occu.26, WFD.occu.27, WFD.occu.28, WFD.occu.29, WFD.occu.30, WFD.occu.31, WFD.occu.32, WFD.occu.33, WFD.occu.34, WFD.occu.35, WFD.occu.36, WFD.occu.37, WFD.occu.38, WFD.occu.39, WFD.occu.40, WFD.occu.41, WFD.occu.42, WFD.occu.43, WFD.occu.44, WFD.occu.45, WFD.occu.46, WFD.occu.47, WFD.occu.48, WFD.occu.49, WFD.occu.50, WFD.occu.51)
obsCov.temp
obsCov.cloud <- data.frame("cloud.v1" = rep(WFD.pres$Cloud[WFD.pres.BNG@data$Date == "16/05/2017"][1], length(WFD.occ.mat[,1])), "cloud.v2" = rep(WFD.pres$Cloud[WFD.pres.BNG@data$Date == "22/05/2017"][1], length(WFD.occ.mat[,1])),"cloud.v3" = rep(WFD.pres$Cloud[WFD.pres.BNG@data$Date == "25/05/2017"][1], length(WFD.occ.mat[,1])),
"cloud.v4" = rep(WFD.pres$Cloud[WFD.pres.BNG@data$Date == "30/05/2017"][1], length(WFD.occ.mat[,1])), "cloud.v5" = rep(WFD.pres$Cloud[WFD.pres.BNG@data$Date == "01/06/2017"][1], length(WFD.occ.mat[,1])), "cloud.v6" = rep(WFD.pres$Cloud[WFD.pres.BNG@data$Date == "07/06/2017"][1], length(WFD.occ.mat[,1])),
"cloud.v7" = rep(WFD.pres$Cloud[WFD.pres.BNG@data$Date == "09/06/2017"][1], length(WFD.occ.mat[,1])), "cloud.v8" = rep(WFD.pres$Cloud[WFD.pres.BNG@data$Date == "13/06/2017"][1], length(WFD.occ.mat[,1])), "cloud.v9" = rep(WFD.pres$Cloud[WFD.pres.BNG@data$Date == "19/06/2017"][1], length(WFD.occ.mat[,1])), "cloud.v10" = rep(WFD.pres$Cloud[WFD.pres.BNG@data$Date == "23/06/2017"][1], length(WFD.occ.mat[,1])), "cloud.v11" = rep(WFD.pres$Cloud[WFD.pres.BNG@data$Date == "26/06/2017"][1], length(WFD.occ.mat[,1])), "cloud.v12" = rep(WFD.pres$Cloud[WFD.pres.BNG@data$Date == "04/07/2017"][1], length(WFD.occ.mat[,1])),
"cloud.v13" = rep(WFD.pres$Cloud[WFD.pres.BNG@data$Date == "07/07/2017"][1], length(WFD.occ.mat[,1])))
obsCov.cloud
obsCov.temp <- data.frame("temp.v1" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "16/05/2017"][1], length(WFD.occ.mat[,1])) ,"temp.v2" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "22/05/2017"][1], length(WFD.occ.mat[,1])),"temp.v3" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "25/05/2017"][1], length(WFD.occ.mat[,1])),
"temp.v4" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "30/05/2017"][1], length(WFD.occ.mat[,1])), "temp.v5" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "01/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v6" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "07/06/2017"][1], length(WFD.occ.mat[,1])),
"temp.v7" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "09/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v8" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "13/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v9" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "19/06/2017"][1], length(WFD.occ.mat[,1])), length(WFD.occ.mat[,1])), "temp.v10" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "23/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v11" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "26/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v12" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "04/07/2017"][1], length(WFD.occ.mat[,1])),
"temp.v13" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "07/07/2017"][1])
obsCov.wind <- data.frame("wind.v1" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "16/05/2017"][1], length(WFD.occ.mat[,1])) ,"wind.v2" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "22/05/2017"][1], length(WFD.occ.mat[,1])),"wind.v3" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "25/05/2017"][1], length(WFD.occ.mat[,1])),
"wind.v4" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "30/05/2017"][1], length(WFD.occ.mat[,1])), "wind.v5" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "01/06/2017"][1], length(WFD.occ.mat[,1])), "wind.v6" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "07/06/2017"][1], length(WFD.occ.mat[,1])),
"wind.v7" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "09/06/2017"][1], length(WFD.occ.mat[,1])), "wind.v8" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "13/06/2017"][1], length(WFD.occ.mat[,1])), "wind.v9" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "19/06/2017"][1], length(WFD.occ.mat[,1]))length(WFD.occ.mat[,1])), "wind.v10" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "23/06/2017"][1], length(WFD.occ.mat[,1])), "wind.v11" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "26/06/2017"][1], length(WFD.occ.mat[,1])), "wind.v12" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "04/07/2017"][1], length(WFD.occ.mat[,1])),
"wind.v13" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "07/07/2017"][1])
obsCov.effort <- data.frame("effort.v1" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "16/05/2017"][1], length(WFD.occ.mat[,1])) ,"effort.v2" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "22/05/2017"][1], length(WFD.occ.mat[,1])),"effort.v3" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "25/05/2017"][1], length(WFD.occ.mat[,1])),
"effort.v4" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "30/05/2017"][1], length(WFD.occ.mat[,1])), "effort.v5" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "01/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v6" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "07/06/2017"][1], length(WFD.occ.mat[,1])),
"effort.v7" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "09/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v8" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "13/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v9" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "19/06/2017"][1], length(WFD.occ.mat[,1])),length(WFD.occ.mat[,1])), "effort.v10" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "23/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v11" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "26/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v12" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "04/07/2017"][1], length(WFD.occ.mat[,1])),
"effort.v13" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "07/07/2017"][1])
obsCov.effort <- data.frame("effort.v1" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "16/05/2017"][1], length(WFD.occ.mat[,1])) ,"effort.v2" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "22/05/2017"][1], length(WFD.occ.mat[,1])),"effort.v3" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "25/05/2017"][1], length(WFD.occ.mat[,1])),
"effort.v4" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "30/05/2017"][1], length(WFD.occ.mat[,1])), "effort.v5" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "01/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v6" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "07/06/2017"][1], length(WFD.occ.mat[,1])),
"effort.v7" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "09/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v8" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "13/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v9" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "19/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v10" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "23/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v11" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "26/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v12" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "04/07/2017"][1], length(WFD.occ.mat[,1])),
"effort.v13" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "07/07/2017"][1])
)
obsCov.temp <- data.frame("temp.v1" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "16/05/2017"][1], length(WFD.occ.mat[,1])) ,"temp.v2" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "22/05/2017"][1], length(WFD.occ.mat[,1])),"temp.v3" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "25/05/2017"][1], length(WFD.occ.mat[,1])),
"temp.v4" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "30/05/2017"][1], length(WFD.occ.mat[,1])), "temp.v5" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "01/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v6" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "07/06/2017"][1], length(WFD.occ.mat[,1])),
"temp.v7" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "09/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v8" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "13/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v9" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "19/06/2017"][1], length(WFD.occ.mat[,1])), length(WFD.occ.mat[,1])), "temp.v10" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "23/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v11" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "26/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v12" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "04/07/2017"][1], length(WFD.occ.mat[,1])),
"temp.v13" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "07/07/2017"][1], length(WFD.occ.mat[,1])))
obsCov.wind <- data.frame("wind.v1" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "16/05/2017"][1], length(WFD.occ.mat[,1])) ,"wind.v2" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "22/05/2017"][1], length(WFD.occ.mat[,1])),"wind.v3" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "25/05/2017"][1], length(WFD.occ.mat[,1])),
"wind.v4" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "30/05/2017"][1], length(WFD.occ.mat[,1])), "wind.v5" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "01/06/2017"][1], length(WFD.occ.mat[,1])), "wind.v6" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "07/06/2017"][1], length(WFD.occ.mat[,1])),
"wind.v7" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "09/06/2017"][1], length(WFD.occ.mat[,1])), "wind.v8" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "13/06/2017"][1], length(WFD.occ.mat[,1])), "wind.v9" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "19/06/2017"][1], length(WFD.occ.mat[,1]))length(WFD.occ.mat[,1])), "wind.v10" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "23/06/2017"][1], length(WFD.occ.mat[,1])), "wind.v11" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "26/06/2017"][1], length(WFD.occ.mat[,1])), "wind.v12" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "04/07/2017"][1], length(WFD.occ.mat[,1])),
"wind.v13" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "07/07/2017"][1], length(WFD.occ.mat[,1])))
obsCov.effort <- data.frame("effort.v1" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "16/05/2017"][1], length(WFD.occ.mat[,1])) ,"effort.v2" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "22/05/2017"][1], length(WFD.occ.mat[,1])),"effort.v3" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "25/05/2017"][1], length(WFD.occ.mat[,1])),
"effort.v4" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "30/05/2017"][1], length(WFD.occ.mat[,1])), "effort.v5" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "01/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v6" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "07/06/2017"][1], length(WFD.occ.mat[,1])),
"effort.v7" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "09/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v8" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "13/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v9" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "19/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v10" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "23/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v11" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "26/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v12" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "04/07/2017"][1], length(WFD.occ.mat[,1])),
"effort.v13" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "07/07/2017"][1]), length(WFD.occ.mat[,1])))
obsCov.effort <- data.frame("effort.v1" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "16/05/2017"][1], length(WFD.occ.mat[,1])) ,"effort.v2" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "22/05/2017"][1], length(WFD.occ.mat[,1])),"effort.v3" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "25/05/2017"][1], length(WFD.occ.mat[,1])),
"effort.v4" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "30/05/2017"][1], length(WFD.occ.mat[,1])), "effort.v5" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "01/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v6" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "07/06/2017"][1], length(WFD.occ.mat[,1])),
"effort.v7" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "09/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v8" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "13/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v9" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "19/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v10" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "23/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v11" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "26/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v12" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "04/07/2017"][1], length(WFD.occ.mat[,1])),
"effort.v13" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "07/07/2017"][1]), length(WFD.occ.mat[,1]))
obsCov.temp
obsCov.temp <- data.frame("temp.v1" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "16/05/2017"][1], length(WFD.occ.mat[,1])) ,"temp.v2" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "22/05/2017"][1], length(WFD.occ.mat[,1])),"temp.v3" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "25/05/2017"][1], length(WFD.occ.mat[,1])),
"temp.v4" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "30/05/2017"][1], length(WFD.occ.mat[,1])), "temp.v5" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "01/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v6" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "07/06/2017"][1], length(WFD.occ.mat[,1])),
"temp.v7" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "09/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v8" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "13/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v9" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "19/06/2017"][1], length(WFD.occ.mat[,1])), length(WFD.occ.mat[,1])), "temp.v10" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "23/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v11" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "26/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v12" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "04/07/2017"][1], length(WFD.occ.mat[,1])),
"temp.v13" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "07/07/2017"][1], length(WFD.occ.mat[,1])))
obsCov.temp <- data.frame("temp.v1" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "16/05/2017"][1], length(WFD.occ.mat[,1])) ,"temp.v2" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "22/05/2017"][1], length(WFD.occ.mat[,1])),"temp.v3" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "25/05/2017"][1], length(WFD.occ.mat[,1])),
"temp.v4" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "30/05/2017"][1], length(WFD.occ.mat[,1])), "temp.v5" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "01/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v6" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "07/06/2017"][1], length(WFD.occ.mat[,1])),
"temp.v7" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "09/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v8" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "13/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v9" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "19/06/2017"][1], length(WFD.occ.mat[,1])), length(WFD.occ.mat[,1])), "temp.v10" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "23/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v11" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "26/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v12" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "04/07/2017"][1], length(WFD.occ.mat[,1])),
"temp.v13" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "07/07/2017"][1], length(WFD.occ.mat[,1])))
obsCov.temp <- data.frame("temp.v1" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "16/05/2017"][1], length(WFD.occ.mat[,1])) ,"temp.v2" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "22/05/2017"][1], length(WFD.occ.mat[,1])),"temp.v3" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "25/05/2017"][1], length(WFD.occ.mat[,1])),
"temp.v4" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "30/05/2017"][1], length(WFD.occ.mat[,1])), "temp.v5" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "01/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v6" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "07/06/2017"][1], length(WFD.occ.mat[,1])),
"temp.v7" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "09/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v8" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "13/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v9" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "19/06/2017"][1], length(WFD.occ.mat[,1])),
"temp.v10" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "23/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v11" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "26/06/2017"][1], length(WFD.occ.mat[,1])), "temp.v12" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "04/07/2017"][1], length(WFD.occ.mat[,1])),
"temp.v13" = rep(WFD.pres$Temp[WFD.pres.BNG@data$Date == "07/07/2017"][1], length(WFD.occ.mat[,1])))
obsCov.wind <- data.frame("wind.v1" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "16/05/2017"][1], length(WFD.occ.mat[,1])) ,"wind.v2" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "22/05/2017"][1], length(WFD.occ.mat[,1])),"wind.v3" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "25/05/2017"][1], length(WFD.occ.mat[,1])),
"wind.v4" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "30/05/2017"][1], length(WFD.occ.mat[,1])), "wind.v5" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "01/06/2017"][1], length(WFD.occ.mat[,1])), "wind.v6" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "07/06/2017"][1], length(WFD.occ.mat[,1])),
"wind.v7" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "09/06/2017"][1], length(WFD.occ.mat[,1])), "wind.v8" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "13/06/2017"][1], length(WFD.occ.mat[,1])), "wind.v9" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "19/06/2017"][1], length(WFD.occ.mat[,1])),
"wind.v10" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "23/06/2017"][1], length(WFD.occ.mat[,1])), "wind.v11" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "26/06/2017"][1], length(WFD.occ.mat[,1])), "wind.v12" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "04/07/2017"][1], length(WFD.occ.mat[,1])),
"wind.v13" = rep(WFD.pres$Wind[WFD.pres.BNG@data$Date == "07/07/2017"][1], length(WFD.occ.mat[,1])))
obsCov.effort <- data.frame("effort.v1" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "16/05/2017"][1], length(WFD.occ.mat[,1])) ,"effort.v2" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "22/05/2017"][1], length(WFD.occ.mat[,1])),"effort.v3" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "25/05/2017"][1], length(WFD.occ.mat[,1])),
"effort.v4" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "30/05/2017"][1], length(WFD.occ.mat[,1])), "effort.v5" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "01/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v6" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "07/06/2017"][1], length(WFD.occ.mat[,1])),
"effort.v7" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "09/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v8" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "13/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v9" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "19/06/2017"][1], length(WFD.occ.mat[,1])),
"effort.v10" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "23/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v11" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "26/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v12" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "04/07/2017"][1], length(WFD.occ.mat[,1])),
"effort.v13" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "07/07/2017"][1]), length(WFD.occ.mat[,1]))
obsCov.temp
WFD.obsCovs <- list(cloud=obsCov.cloud[-c(40, 41, 47, 49, 57, 58, 62:64),-c(5:8)], temp=obsCov.temp-c(40, 41, 47, 49, 57, 58, 62:64), -c(5:8)], wind=obsCov.wind-c(40, 41, 47, 49, 57, 58, 62:64), -c(5:8)], effort=obsCov.effort-c(40, 41, 47, 49, 57, 58, 62:64), -c(5:8)])
#WFD.UMF <- unmarkedFrameOccu(y = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64),3:15], siteCovs = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64),16:20], obsCovs = WFD.obsCovs)
WFD.UMF <- unmarkedFrameOccu(y = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64), c(3:6, 11:15)], siteCovs = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64),16:20], obsCovs = WFD.obsCovs)
#### Build UMF using data from csv files
# Creat observation covariates list
#WFD.obsCovs <- list(cloud=obsCov.cloud[-c(40, 41, 47, 49, 57, 58, 62:64),], temp=obsCov.temp[-c(40, 41, 47, 49, 57, 58, 62:64),], wind=obsCov.wind[-c(40, 41, 47, 49, 57, 58, 62:64),], effort=obsCov.effort[-c(40, 41, 47, 49, 57, 58, 62:64),])
WFD.obsCovs <- list(cloud=obsCov.cloud[-c(40, 41, 47, 49, 57, 58, 62:64),-c(5:8)], temp=obsCov.temp[-c(40, 41, 47, 49, 57, 58, 62:64), -c(5:8)], wind=obsCov.wind-c(40, 41, 47, 49, 57, 58, 62:64), -c(5:8)], effort=obsCov.effort-c(40, 41, 47, 49, 57, 58, 62:64), -c(5:8)])
#### Build UMF using data from csv files
# Creat observation covariates list
#WFD.obsCovs <- list(cloud=obsCov.cloud[-c(40, 41, 47, 49, 57, 58, 62:64),], temp=obsCov.temp[-c(40, 41, 47, 49, 57, 58, 62:64),], wind=obsCov.wind[-c(40, 41, 47, 49, 57, 58, 62:64),], effort=obsCov.effort[-c(40, 41, 47, 49, 57, 58, 62:64),])
WFD.obsCovs <- list(cloud=obsCov.cloud[-c(40, 41, 47, 49, 57, 58, 62:64),-c(5:8)], temp=obsCov.temp[-c(40, 41, 47, 49, 57, 58, 62:64), -c(5:8)], wind=obsCov.wind[-c(40, 41, 47, 49, 57, 58, 62:64), -c(5:8)], effort=obsCov.effort[-c(40, 41, 47, 49, 57, 58, 62:64), -c(5:8)])
#WFD.UMF <- unmarkedFrameOccu(y = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64),3:15], siteCovs = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64),16:20], obsCovs = WFD.obsCovs)
WFD.UMF <- unmarkedFrameOccu(y = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64), c(3:6, 11:15)], siteCovs = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64),16:20], obsCovs = WFD.obsCovs)
WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64), c(3:6, 11:15)]
#WFD.UMF <- unmarkedFrameOccu(y = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64),3:15], siteCovs = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64),16:20], obsCovs = WFD.obsCovs)
WFD.UMF <- unmarkedFrameOccu(y = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64), c(3:6, 11:15)], siteCovs = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64),16:20], obsCovs = WFD.obsCovs)
nrow(WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64), c(3:6, 11:15)])
ncol(WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64), c(3:6, 11:15)])
nrow(WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64),16:20])
nrow(obsCov.cloud[-c(40, 41, 47, 49, 57, 58, 62:64),-c(5:8)])
ncol(obsCov.cloud[-c(40, 41, 47, 49, 57, 58, 62:64),-c(5:8)])
#WFD.UMF <- unmarkedFrameOccu(y = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64),3:15], siteCovs = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64),16:20], obsCovs = WFD.obsCovs)
WFD.UMF <- unmarkedFrameOccu(y = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64), c(3:6, 11:15)], siteCovs = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64),16:20])
#### Build UMF using data from csv files
# Creat observation covariates list
#WFD.obsCovs <- list(cloud=obsCov.cloud[-c(40, 41, 47, 49, 57, 58, 62:64),], temp=obsCov.temp[-c(40, 41, 47, 49, 57, 58, 62:64),], wind=obsCov.wind[-c(40, 41, 47, 49, 57, 58, 62:64),], effort=obsCov.effort[-c(40, 41, 47, 49, 57, 58, 62:64),])
WFD.obsCovs <- list(cloud=obsCov.cloud[-c(40, 41, 47, 49, 57, 58, 62:64),-c(5:8)], temp=obsCov.temp[-c(40, 41, 47, 49, 57, 58, 62:64), -c(5:8)], wind=obsCov.wind[-c(40, 41, 47, 49, 57, 58, 62:64), -c(5:8)], effort=obsCov.effort[-c(40, 41, 47, 49, 57, 58, 62:64), -c(5:8)])
#WFD.UMF <- unmarkedFrameOccu(y = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64),3:15], siteCovs = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64),16:20], obsCovs = WFD.obsCovs)
WFD.UMF <- unmarkedFrameOccu(y = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64), c(3:6, 11:15)], siteCovs = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64),16:20], obsCovs = WFD.obsCovs)
obsCovs
nrow(obsCov.temp[-c(40, 41, 47, 49, 57, 58, 62:64), -c(5:8)])
ncol(obsCov.temp[-c(40, 41, 47, 49, 57, 58, 62:64), -c(5:8)])
nrow(obsCov.wind[-c(40, 41, 47, 49, 57, 58, 62:64), -c(5:8)])
ncol(obsCov.wind[-c(40, 41, 47, 49, 57, 58, 62:64), -c(5:8)])
nrow(obsCov.effort[-c(40, 41, 47, 49, 57, 58, 62:64), -c(5:8)])
ncol(obsCov.effort[-c(40, 41, 47, 49, 57, 58, 62:64), -c(5:8)])
obsCov.effort
obsCov.effort <- data.frame("effort.v1" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "16/05/2017"][1], length(WFD.occ.mat[,1])) ,"effort.v2" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "22/05/2017"][1], length(WFD.occ.mat[,1])),"effort.v3" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "25/05/2017"][1], length(WFD.occ.mat[,1])),
"effort.v4" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "30/05/2017"][1], length(WFD.occ.mat[,1])), "effort.v5" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "01/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v6" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "07/06/2017"][1], length(WFD.occ.mat[,1])),
"effort.v7" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "09/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v8" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "13/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v9" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "19/06/2017"][1], length(WFD.occ.mat[,1])),
"effort.v10" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "23/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v11" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "26/06/2017"][1], length(WFD.occ.mat[,1])), "effort.v12" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "04/07/2017"][1], length(WFD.occ.mat[,1])),
"effort.v13" = rep(WFD.pres$Effort[WFD.pres.BNG@data$Date == "07/07/2017"][1], length(WFD.occ.mat[,1])))
#### Build UMF using data from csv files
# Creat observation covariates list
#WFD.obsCovs <- list(cloud=obsCov.cloud[-c(40, 41, 47, 49, 57, 58, 62:64),], temp=obsCov.temp[-c(40, 41, 47, 49, 57, 58, 62:64),], wind=obsCov.wind[-c(40, 41, 47, 49, 57, 58, 62:64),], effort=obsCov.effort[-c(40, 41, 47, 49, 57, 58, 62:64),])
WFD.obsCovs <- list(cloud=obsCov.cloud[-c(40, 41, 47, 49, 57, 58, 62:64),-c(5:8)], temp=obsCov.temp[-c(40, 41, 47, 49, 57, 58, 62:64), -c(5:8)], wind=obsCov.wind[-c(40, 41, 47, 49, 57, 58, 62:64), -c(5:8)], effort=obsCov.effort[-c(40, 41, 47, 49, 57, 58, 62:64), -c(5:8)])
#WFD.UMF <- unmarkedFrameOccu(y = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64),3:15], siteCovs = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64),16:20], obsCovs = WFD.obsCovs)
WFD.UMF <- unmarkedFrameOccu(y = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64), c(3:6, 11:15)], siteCovs = WFD.occ.mat[-c(40, 41, 47, 49, 57, 58, 62:64),16:20], obsCovs = WFD.obsCovs)
WFD.occu <- occu(~1 ~1, WFD.UMF)
summary(WFD.occu)
WFD.occu.1 <- occu(~1 ~ moss + scrubMoss + water, WFD.UMF)
WFD.occu.2 <- occu(~1 ~ moss + scrub + water, WFD.UMF)
WFD.occu.3 <- occu(~1 ~ moss + scrubMoss, WFD.UMF)
WFD.occu.4 <- occu(~1 ~ moss + scrub, WFD.UMF)
WFD.occu.5 <- occu(~1 ~ scrubMoss + water, WFD.UMF)
WFD.occu.6 <- occu(~1 ~ scrub + water, WFD.UMF)
WFD.occu.7 <- occu(~1 ~ moss + water, WFD.UMF)
WFD.occu.8 <- occu(~1 ~ moss, WFD.UMF)
WFD.occu.9 <- occu(~1 ~ scrub, WFD.UMF)
WFD.occu.10 <- occu(~1 ~ scrubMoss, WFD.UMF)
WFD.occu.11 <- occu(~1 ~ moss + scrub + water + wood, WFD.UMF)
WFD.occu.12 <- occu(~1 ~ moss + scrub + wood, WFD.UMF)
WFD.occu.13 <- occu(~1 ~ scrub + water + wood, WFD.UMF)
WFD.occu.14 <- occu(~1 ~ moss + water + wood, WFD.UMF)
WFD.occu.15 <- occu(~1 ~ moss + wood, WFD.UMF)
WFD.occu.16 <- occu(~1 ~ scrub + wood, WFD.UMF)
WFD.occu.17 <- occu(~1 ~ wood, WFD.UMF)
WFD.occu.18 <- occu(~wind ~ moss + scrubMoss + water, WFD.UMF)
WFD.occu.19 <- occu(~wind ~ moss + scrub + water, WFD.UMF)
WFD.occu.20 <- occu(~wind ~ moss + scrubMoss, WFD.UMF)
WFD.occu.21 <- occu(~wind ~ moss + scrub, WFD.UMF)
WFD.occu.22 <- occu(~wind ~ scrubMoss + water, WFD.UMF)
WFD.occu.23 <- occu(~wind ~ scrub + water, WFD.UMF)
WFD.occu.24 <- occu(~wind ~ moss + water, WFD.UMF)
WFD.occu.25 <- occu(~wind ~ moss, WFD.UMF)
WFD.occu.26 <- occu(~wind ~ scrub, WFD.UMF)
WFD.occu.27 <- occu(~wind ~ scrubMoss, WFD.UMF)
WFD.occu.28 <- occu(~wind ~ moss + scrub + water + wood, WFD.UMF)
WFD.occu.29 <- occu(~wind ~ moss + scrub + wood, WFD.UMF)
WFD.occu.30 <- occu(~wind ~ scrub + water + wood, WFD.UMF)
WFD.occu.31 <- occu(~wind ~ moss + water + wood, WFD.UMF)
WFD.occu.32 <- occu(~wind ~ moss + wood, WFD.UMF)
WFD.occu.33 <- occu(~wind ~ scrub + wood, WFD.UMF)
WFD.occu.34 <- occu(~wind ~ wood, WFD.UMF)
WFD.occu.35 <- occu(~temp ~ moss + scrubMoss + water, WFD.UMF)
WFD.occu.36 <- occu(~temp ~ moss + scrub + water, WFD.UMF)
WFD.occu.37 <- occu(~temp ~ moss + scrubMoss, WFD.UMF)
WFD.occu.38 <- occu(~temp ~ moss + scrub, WFD.UMF)
WFD.occu.39 <- occu(~temp ~ scrubMoss + water, WFD.UMF)
WFD.occu.40 <- occu(~temp ~ scrub + water, WFD.UMF)
WFD.occu.41 <- occu(~temp ~ moss + water, WFD.UMF)
WFD.occu.42 <- occu(~temp ~ moss, WFD.UMF)
WFD.occu.43 <- occu(~temp ~ scrub, WFD.UMF)
WFD.occu.44 <- occu(~temp ~ scrubMoss, WFD.UMF)
WFD.occu.45 <- occu(~temp ~ moss + scrub + water + wood, WFD.UMF)
WFD.occu.46 <- occu(~temp ~ moss + scrub + wood, WFD.UMF)
WFD.occu.47 <- occu(~temp ~ scrub + water + wood, WFD.UMF)
WFD.occu.48 <- occu(~temp ~ moss + water + wood, WFD.UMF)
WFD.occu.49 <- occu(~temp ~ moss + wood, WFD.UMF)
WFD.occu.50 <- occu(~temp ~ scrub + wood, WFD.UMF)
WFD.occu.51 <- occu(~temp ~ wood, WFD.UMF)
### Doesn't work when predictors not scaled but works for best model
WFD.mods <- fitList(WFD.occu, WFD.occu.1, WFD.occu.2, WFD.occu.3, WFD.occu.4, WFD.occu.5, WFD.occu.6, WFD.occu.7, WFD.occu.8, WFD.occu.9, WFD.occu.10, WFD.occu.11,WFD.occu.12, WFD.occu.13, WFD.occu.14, WFD.occu.15, WFD.occu.16, WFD.occu.17, WFD.occu.18, WFD.occu.19, WFD.occu.20, WFD.occu.21, WFD.occu.22, WFD.occu.23, WFD.occu.24, WFD.occu.25, WFD.occu.26, WFD.occu.27, WFD.occu.28, WFD.occu.29, WFD.occu.30, WFD.occu.31, WFD.occu.32, WFD.occu.33, WFD.occu.34, WFD.occu.35, WFD.occu.36, WFD.occu.37, WFD.occu.38, WFD.occu.39, WFD.occu.40, WFD.occu.41, WFD.occu.42, WFD.occu.43, WFD.occu.44, WFD.occu.45, WFD.occu.46, WFD.occu.47, WFD.occu.48, WFD.occu.49, WFD.occu.50, WFD.occu.51)
### Doesn't work when predictors not scaled but works for best model
#WFD.mods <- fitList(WFD.occu, WFD.occu.1, WFD.occu.2, WFD.occu.3, WFD.occu.4, WFD.occu.5, WFD.occu.6, WFD.occu.7, WFD.occu.8, WFD.occu.9, WFD.occu.10, WFD.occu.11,WFD.occu.12, WFD.occu.13, WFD.occu.14, WFD.occu.15, WFD.occu.16, WFD.occu.17, WFD.occu.18, WFD.occu.19, WFD.occu.20, WFD.occu.21, WFD.occu.22, WFD.occu.23, WFD.occu.24, WFD.occu.25, WFD.occu.26, WFD.occu.27, WFD.occu.28, WFD.occu.29, WFD.occu.30, WFD.occu.31, WFD.occu.32, WFD.occu.33, WFD.occu.34, WFD.occu.35, WFD.occu.36, WFD.occu.37, WFD.occu.38, WFD.occu.39, WFD.occu.40, WFD.occu.41, WFD.occu.42, WFD.occu.43, WFD.occu.44, WFD.occu.45, WFD.occu.46, WFD.occu.47, WFD.occu.48, WFD.occu.49, WFD.occu.50, WFD.occu.51)
WFD.mods <- fitList(WFD.occu, WFD.occu.1, WFD.occu.2, WFD.occu.3, WFD.occu.4, WFD.occu.5, WFD.occu.6, WFD.occu.7, WFD.occu.9, WFD.occu.10, WFD.occu.11,WFD.occu.12, WFD.occu.13, WFD.occu.14, WFD.occu.16, WFD.occu.17, WFD.occu.18, WFD.occu.19, WFD.occu.20, WFD.occu.21, WFD.occu.22, WFD.occu.23, WFD.occu.24, WFD.occu.26, WFD.occu.27, WFD.occu.28, WFD.occu.29, WFD.occu.30, WFD.occu.31, WFD.occu.33, WFD.occu.34, WFD.occu.35, WFD.occu.36, WFD.occu.37, WFD.occu.38, WFD.occu.39, WFD.occu.40, WFD.occu.41, WFD.occu.42, WFD.occu.43, WFD.occu.44, WFD.occu.45, WFD.occu.46, WFD.occu.47, WFD.occu.48, WFD.occu.49, WFD.occu.50, WFD.occu.51)
modSel(WFD.mods)
summary(WFD.occu.3)
## Detectability
backTransform(linearComb(WFD.occu.3, coefficients = c(1), type = 'det'))
## Detectability
backTransform(linearComb(WFD.occu.3, coefficients = c(1), type = 'det'))
new.dat<- data.frame(moss=seq(min(siteCovs(WFD.UMF)$moss),max(siteCovs(WFD.UMF)$moss),,20))
WFD.pred<-predict(WFD.occu.17,type="state",newdata=new.dat,appendData=TRUE)
new.dat
new.dat<- data.frame(moss=seq(min(siteCovs(WFD.UMF)$moss),max(siteCovs(WFD.UMF)$moss),,20), scrubMoss = 0)
WFD.pred<-predict(WFD.occu.17,type="state",newdata=new.dat,appendData=TRUE)
WFD.pred<-predict(WFD.occu.3,type="state",newdata=new.dat,appendData=TRUE)
plot(Predicted ~ moss, WFD.pred,type="l",xlab="Proportion of woodland in 100 m square",
ylab="Probability of Occupancy",ylim=c(0,1))
lines(lower ~ moss, WFD.pred,type="l",col="red")
lines(upper ~ moss, WFD.pred,type="l",col="red")
plot(Predicted ~ moss, WFD.pred,type="l",xlab="Proportion of moss in 100 m square",
ylab="Probability of Occupancy",ylim=c(0,1))
lines(lower ~ moss, WFD.pred,type="l",col="red")
lines(upper ~ moss, WFD.pred,type="l",col="red")
# Load presence data
### Wind score of 6+ changed to 7 for ease of interpretation
WFD.pres <- read.csv("FW_presdata.csv")
plot(WFD.pres$Long, WFD.pres$Lat)
## Add 'presence' column
WFD.pres$pres <- 1
## Create spatial object for presence points
WFD.pres.latlong <- SpatialPointsDataFrame(data.frame(WFD.pres$Long, WFD.pres$Lat), data = WFD.pres, proj4string = CRS(latlong))
library(raster)
library(reshape2)
library(unmarked)
latlong <- "+init=epsg:4326"
ukgrid <- "+init=epsg:27700"
## Create spatial object for presence points
WFD.pres.latlong <- SpatialPointsDataFrame(data.frame(WFD.pres$Long, WFD.pres$Lat), data = WFD.pres, proj4string = CRS(latlong))
## Convert to BNG
WFD.pres.BNG <-  spTransform(WFD.pres.latlong,  CRS(ukgrid))
## Add trasnsformed x and y values to data frame
WFD.pres.BNG@data$x <- WFD.pres.BNG@coords[,1]
WFD.pres.BNG@data$y <- WFD.pres.BNG@coords[,2]
# Create habitat rasters
## Define extent
#fenn.ext <- extent(c(348000, 350000, 335000, 337000)) ## Previous extent needs correcting
fenn.ext <- extent(c(347890, 349890, 335000, 337000)) ## Corrected visually using Google maps
moss <- raster(as.matrix(read.csv("FW_hab/Fenns_Moss.csv", header = FALSE)), crs = crs(ukgrid))
extent(moss) <- fenn.ext
writeRaster(moss, "FW_hab/Fenns_moss.img", overwrite = TRUE)
scrub <- raster(as.matrix(read.csv("FW_hab/Fenns_Scrub.csv", header = FALSE)), crs = crs(ukgrid))
extent(scrub) <- fenn.ext
writeRaster(scrub, "FW_hab/Fenns_scrub.img", overwrite = TRUE)
scrubMoss <- raster(as.matrix(read.csv("FW_hab/Fenns_ScrubMoss.csv", header = FALSE)), crs = crs(ukgrid))
extent(scrubMoss) <- fenn.ext
writeRaster(scrubMoss, "FW_hab/Fenns_scrubmoss.img", overwrite = TRUE)
water <- raster(as.matrix(read.csv("FW_hab/Fenns_Water.csv", header = FALSE)), crs = crs(ukgrid)) ## Water matrix corrected visually using aerial photographs (Google maps)
extent(water) <- fenn.ext
writeRaster(water, "FW_hab/Fenns_water.img", overwrite = TRUE)
wood <- raster(as.matrix(read.csv("FW_hab/Fenns_Wood.csv", header = FALSE)), crs = crs(ukgrid))
extent(wood) <- fenn.ext
writeRaster(wood, "FW_hab/Fenns_wood.img", overwrite = TRUE)
wood.vect <- getValues(wood.vect)
wood.vect <- getValues(wood)
wood.vect
length(wood.vect)
moss.vect <- getValues(moss)
length(moss.vect)
hab.dat <- data.frame(moss = getValues(moss), scrub = getValues(scrub), scrubMoss = getValues(scrubMoss), water = getValues(water), wood = getValues(wood))
head(hab.dat)
which.max(hab.dat[200,])
hab.dat
which.max(hab.dat[197,])
names(hab.dat)[which.max(hab.dat[197,])]
dom.hab <- function(x, n){
y <- n[which.max(x)]
return(y)
}
?apply
hab.dat$dom <- apply(hab.dat, 1, dom.hab, x = hab.dat, n = names(hab.dat))
traceback()
hab.names <- names(hab.dat)
hab.dat$dom <- apply(hab.dat, 1, dom.hab, x = hab.dat, n = hab.names)
dom.hab(hab.dat[197,], hab.names)
dom.hab(hab.dat[200,], hab.names)
max(hab.dat[200,])
dom.hab <- function(x, n){
if(is.na(max(x))){
y <- NA
}
else{
y <- n[which.max(x)]
}
return(y)
}
dom.hab(hab.dat[197,], hab.names)
dom.hab(hab.dat[200,], hab.names)
hab.dat$dom <- apply(hab.dat, 1, dom.hab, x = hab.dat, n = hab.names)
for(i in 1:length(hab.dat[,1])){
hab.dat$dom <- dom.hab(hab.dat[i,], hab.names)
}
head(hab.dat)
summary(hab.dat)
for(i in 1:length(hab.dat[,1])){
hab.dat$dom <- dom.hab(hab.dat[i,], hab.names)
}$
hab.dat$dom <- dom.hab(hab.dat[197,], hab.names)
for(i in 1:length(hab.dat[,1])){
hab.dat$dom <- dom.hab(hab.dat[i,], hab.names)
}$
hab.dat$dom[197,] <- dom.hab(hab.dat[197,], hab.names)
dom.hab(hab.dat[197,], hab.names)
hab.dat <- data.frame(moss = getValues(moss), scrub = getValues(scrub), scrubMoss = getValues(scrubMoss), water = getValues(water), wood = getValues(wood))
dom.hab(hab.dat[197,], hab.names)
for(i in 1:length(hab.dat[,1])){
hab.dom.vals <- dom.hab(hab.dat[i,], hab.names)
}
hab.dom.vals
for(i in 1:length(hab.dat[,1])){
hab.dat$dom[i] <- dom.hab(hab.dat[i,], hab.names)
}
summary(hab.dat)
dom.hab(hab.dat[197,], hab.names)
hab.dat <- data.frame(moss = getValues(moss), scrub = getValues(scrub), scrubMoss = getValues(scrubMoss), water = getValues(water), wood = getValues(wood))
dom.hab(hab.dat[197,], hab.names)
dom.hab.vals <- character(0)
dom.hab.vals <- character(400)
dom.hab.vals[1] <- dom.hab(hab.dat[1,], hab.names)
head(dom.hab.vals)
dom.hab.vals[2] <- dom.hab(hab.dat[2,], hab.names)
head(dom.hab.vals)
for(i in 1:length(hab.dat[,1])){
dom.hab.vals[i] <- dom.hab(hab.dat[i,], hab.names)
}
summary(dom.hab.vals)
dom.hab.vals
hab.dat$dom <- dom.hab.vals
head(hab.dat)
summary(hab.dat)
levels(dom)
levels(hab.datdom)
levels(hab.dat$dom)
hab.dat$dom <- as.factor(dom.hab.vals)
summary(hab.dat)
?extract
extract(wood, WFD.pres.BNG)
pres.hab <- data.frame(moss = extract(moss, WFD.pres.BNG), scrub = extract(scrub, WFD.pres.BNG), scrubMoss = extract(scrubMoss, WFD.pres.BNG), water = extract(water, WFD.pres.BNG), wood = extract(wood, WFD.pres.BNG))
head(pres.hab)
length(pres.hab[,1])
pres.hab.vals <- character(258)
for(i in 1:length(pres.hab[,1])){
pres.hab.vals[i] <- dom.hab(pres.hab[i,], hab.names)
}
pres.hab$dom <- as.factor(pres.hab.vals)
head(pres.hab)
table(hab.dat$dom)
table(hab.dat$dom)/133
table(pres.hab$dom)
table(pres.hab$dom)/224
sum(table(pres.hab$dom))
selection.index <- (table(pres.hab$dom)/sum(table(pres.hab$dom)))/(table(hab.dat$dom)/sum(table(hab.dat$dom)))
(table(pres.hab$dom)/sum(table(pres.hab$dom)))
(table(hab.dat$dom)/sum(table(hab.dat$dom)))
w.i <- table(pres.hab$dom)/sum(table(pres.hab$dom))
pi.i <- table(hab.dat$dom)/sum(table(hab.dat$dom))
w.i/pi.i
w.i <- as.vector(table(pres.hab$dom)/sum(table(pres.hab$dom)))
w.i
selection.index <- as.vector(w.i)/as.vector(pi.i)
w.i
pi.i
w.i <- table(pres.hab$dom)/sum(table(pres.hab$dom))
w.i
pi.i <- table(hab.dat$dom)/sum(table(hab.dat$dom))[-3]
pi.i
pi.i[3]
pi.i[4]
pi.i <- table(hab.dat$dom)/sum(table(hab.dat$dom))[-3]
pi.i
table(hab.dat$dom)[-4]
table(hab.dat$dom)[-4]
w.i <- table(pres.hab$dom)/sum(table(pres.hab$dom))
pi.i <- table(hab.dat$dom)[-4]/sum(table(hab.dat$dom)[-4])
selection.index <- as.vector(w.i)/as.vector(pi.i)
names(selection.index) <- names(w.i)
selection.index
plot(selection.index)
plot(selection.index, names(selection.index))
barplot(selection.index, names(selection.index))
barplot(selection.index)
names(selection.index) <- c("Open moss", "Scrub", "Scrub & Moss", "Woodland")
barplot(selection.index, ylab = "Neu's selection index", xlab = "Habitat type")
library(rticles)
rmarkdown::draft("my_article.Rmd", template = "jss_article", package = "rticles")
hello
rmarkdown::draft("my_article.Rmd", template = "jss_article", package = "rticles")
hello
rmarkdown::draft("my_article.Rmd", template = "jss_article", package = "rticles")
citation()
knitr::opts_chunk$set(echo = FALSE)
mark<-read.csv("mark.csv")
knitr::opts_chunk$set(echo = FALSE, message = FALSE)
library(raster)
library(reshape2)
library(unmarked)
latlong <- "+init=epsg:4326"
ukgrid <- "+init=epsg:27700"
# Load presence data
### Wind score of 6+ changed to 7 for ease of interpretation
WFD.pres <- read.csv("FW_presdata.csv")
#plot(WFD.pres$Long, WFD.pres$Lat)
## Add 'presence' column
WFD.pres$pres <- 1
## Create spatial object for presence points
WFD.pres.latlong <- SpatialPointsDataFrame(data.frame(WFD.pres$Long, WFD.pres$Lat), data = WFD.pres, proj4string = CRS(latlong))
## Convert to BNG
WFD.pres.BNG <-  spTransform(WFD.pres.latlong,  CRS(ukgrid))
## Add trasnsformed x and y values to data frame
WFD.pres.BNG@data$x <- WFD.pres.BNG@coords[,1]
WFD.pres.BNG@data$y <- WFD.pres.BNG@coords[,2]
# Create habitat rasters
## Define extent
#fenn.ext <- extent(c(348000, 350000, 335000, 337000)) ## Previous extent needs correcting
fenn.ext <- extent(c(347890, 349890, 335000, 337000)) ## Corrected visually using Google maps
moss <- raster(as.matrix(read.csv("FW_hab/Fenns_Moss.csv", header = FALSE)), crs = crs(ukgrid))
extent(moss) <- fenn.ext
writeRaster(moss, "FW_hab/Fenns_moss.img", overwrite = TRUE)
scrub <- raster(as.matrix(read.csv("FW_hab/Fenns_Scrub.csv", header = FALSE)), crs = crs(ukgrid))
extent(scrub) <- fenn.ext
writeRaster(scrub, "FW_hab/Fenns_scrub.img", overwrite = TRUE)
scrubMoss <- raster(as.matrix(read.csv("FW_hab/Fenns_ScrubMoss.csv", header = FALSE)), crs = crs(ukgrid))
extent(scrubMoss) <- fenn.ext
writeRaster(scrubMoss, "FW_hab/Fenns_scrubmoss.img", overwrite = TRUE)
water <- raster(as.matrix(read.csv("FW_hab/Fenns_Water.csv", header = FALSE)), crs = crs(ukgrid)) ## Water matrix corrected visually using aerial photographs (Google maps)
extent(water) <- fenn.ext
writeRaster(water, "FW_hab/Fenns_water.img", overwrite = TRUE)
wood <- raster(as.matrix(read.csv("FW_hab/Fenns_Wood.csv", header = FALSE)), crs = crs(ukgrid))
extent(wood) <- fenn.ext
writeRaster(wood, "FW_hab/Fenns_wood.img", overwrite = TRUE)
hab.dat <- data.frame(moss = getValues(moss), scrub = getValues(scrub), scrubMoss = getValues(scrubMoss), water = getValues(water), wood = getValues(wood))
### Funtion to select and print dominant habitat
## x is data frame of habitat proportions
## n is names of columns
dom.hab <- function(x, n){
if(is.na(max(x))){
y <- NA
}
else{
y <- n[which.max(x)]
}
return(y)
}
hab.names <- names(hab.dat)
dom.hab.vals <- character(400)
for(i in 1:length(hab.dat[,1])){
dom.hab.vals[i] <- dom.hab(hab.dat[i,], hab.names)
}
hab.dat$dom <- as.factor(dom.hab.vals)
pres.hab <- data.frame(moss = extract(moss, WFD.pres.BNG), scrub = extract(scrub, WFD.pres.BNG), scrubMoss = extract(scrubMoss, WFD.pres.BNG), water = extract(water, WFD.pres.BNG), wood = extract(wood, WFD.pres.BNG))
pres.hab.vals <- character(258)
for(i in 1:length(pres.hab[,1])){
pres.hab.vals[i] <- dom.hab(pres.hab[i,], hab.names)
}
pres.hab$dom <- as.factor(pres.hab.vals)
w.i <- table(pres.hab$dom)/sum(table(pres.hab$dom))
pi.i <- table(hab.dat$dom)[-4]/sum(table(hab.dat$dom)[-4])
selection.index <- as.vector(w.i)/as.vector(pi.i)
names(selection.index) <- c("Open moss", "Scrub", "Scrub & Moss", "Woodland")
